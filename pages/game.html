<!DOCTYPE html>
<html>
    <head>
        <title>DJCC GAMESHOW</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="game.css">
    </head>
    <body>
        <div id="crest">
            <h1>DJCC'S Gameshow</h1>
            <img src="funny-man-watermelon-helmet-googles-260nw-157354478.webp" width="100" height="100"/>
        </div>

        <div id="question-section">
            <div class="question-box">
                <textarea id="question" rows = 20 cols="30" disabled></textarea>
            </div>
            <div class="multiple-choice">
                <p>OPTIONS:</p>
                <div>A</div> <input type="button" id="option1" value="">
                <div>B</div> <input type="button" id="option2" value="">
                <div>C</div> <input type="button" id="option3" value="">
                <div>D</div> <input type="button" id="option4" value="">
            </div>
        </div>
        <ul id="list"></ul>
    </body>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const list = document.getElementById("list");
        const textId = document.getElementById("question");
        const button1 = document.getElementById("option1");
        const button2 = document.getElementById("option2");
        const button3 = document.getElementById("option3");
        const button4 = document.getElementById("option4");
        
        let name = ""
        while (name == "" || !name) {
            name = prompt('Enter name');
        }

        socket.emit("newUser", name);

        socket.on("userJoined", (obj) => {
            const lister = document.createElement("li");
            lister.textContent = obj.name + " | " + obj.points + " points.";
            
            list.appendChild(lister);
        })

        socket.on("skibidiQuestions", (obj) => {
            textId.value = obj[0];

            for(let i = 0; i < obj[1].length; i++) {
                document.getElementById("option" + (i + 1)).value = obj[1][i]

                document.getElementById("option" + (i + 1)).addEventListener("click", () => {
                    console.log(obj)
                    socket.emit("userPicked", textId.value, obj[1][i])
                });
            }
        });
        
        socket.on("awardPoints", (obj) => {
            console.log(obj)
            const liElements = list.querySelectorAll('li');

            // Log the LI elements
            liElements.forEach((li) => {
                if (li.textContent.startsWith(obj.name)) {
                    li.textContent = obj.name + " | " + obj.points + " points.";
                }
            });
        })
    </script>
</html>
